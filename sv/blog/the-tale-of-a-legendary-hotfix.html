<!DOCTYPE html>
<html lang="sv" dir="ltr">


<!-- Mirrored from obsproject.com/sv/blog/the-tale-of-a-legendary-hotfix by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 31 Dec 2023 03:57:04 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
  <title>What happened with 27.2: The tale of a legendary hotfix | OBS</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1.0">
      <meta name="description" content="That was a crazy week. Let’s talk about what happened with 27.2 and what we had to do this past week. With the Windows version of 27.2, we updated all of our dependencies. A …">
    <meta name="keywords" content="OBS, OBS Studio, Stream, Video, Live Streaming, Recording, Games, Twitch, YouTube, Livestream, Open Broadcaster Software">
    <!--<link rel="preload" href="/assets/fonts/open-sans-v18-latin-ext_latin_cyrillic-regular.woff2" as="font" type="font/woff2" crossorigin>-->
  <link href="https://obsproject.com/assets/css/blurple.min.css?20230116-1" rel="stylesheet">    <link rel="alternate" type="application/rss+xml" title="RSS Feed obsproject.com" href="https://obsproject.com/blog/rss">
  <link rel="icon" type="image/png" sizes="32x32" href="https://obsproject.com/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="https://obsproject.com/favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://obsproject.com/favicon-16x16.png">
                    <link rel="alternate" hreflang="cs" href="https://obsproject.com/cs/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="da" href="https://obsproject.com/da/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="de" href="https://obsproject.com/de/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="en" href="https://obsproject.com/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="es" href="https://obsproject.com/es/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="eu" href="https://obsproject.com/eu/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="fi" href="https://obsproject.com/fi/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="fr" href="https://obsproject.com/fr/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="hu" href="https://obsproject.com/hu/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="ja" href="https://obsproject.com/ja/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="ko" href="https://obsproject.com/ko/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="pt-br" href="https://obsproject.com/pt-br/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="ru" href="https://obsproject.com/ru/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="sv" href="https://obsproject.com/sv/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="tr" href="https://obsproject.com/tr/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="uk" href="https://obsproject.com/uk/blog/the-tale-of-a-legendary-hotfix">
                        <link rel="alternate" hreflang="zh-cn" href="https://obsproject.com/zh-cn/blog/the-tale-of-a-legendary-hotfix">
              <script async src="https://www.googletagmanager.com/gtag/js?id=UA-34644124-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];

    function gtag() {
      dataLayer.push(arguments);
    }
    gtag('js', new Date());
    gtag('config', 'UA-34644124-1', {
      'anonymize_ip': true
    });
  </script>
</head>

<body class="">

  <div id="wrapper">

    <header id="header" class="cf">
      <a class="logo" href="https://obsproject.com/sv">
        <img src="https://obsproject.com/assets/images/new_icon_small-r.png" alt="OBS" />
      </a>

      <div class="header_title">
        <div class="header_title_main">OBS</div>
        <div class="header_subtitle">Open Broadcaster Software<span class="smalltext">®️</span></div>
      </div>

      <div id="SocialButtons">

        <div id="DiscordButton">
          <a href="https://discord.gg/obsproject" target="_blank" aria-label="OBS Discord">
            <img src="https://obsproject.com/assets/images/Discord.svg" class="icon-discord" />
          </a>
          <span class="tooltip">Discord</span>
        </div>

        <div id="TwitterButton">
          <a rel="me" href="https://twitter.com/OBSProject" target="_blank" aria-label="OBS Twitter">
            <i class="icon-twitter"></i>
          </a>
          <span class="tooltip">Twitter</span>
        </div>

        <div id="MastodonButton">
          <a rel="me" href="https://mastodon.social/@OBSProject" target="_blank" aria-label="OBS Mastodon">
            <img src="https://obsproject.com/assets/images/Mastodon.svg" class="icon-mastodon">
          </a>
          <span class="tooltip">Mastodon</span>
        </div>

        <div id="GitHubButton">
          <a rel="me" href="https://github.com/obsproject/obs-studio" target="_blank" aria-label="OBS Studio GitHub">
            <i class="icon-github"></i>
          </a>
          <span class="tooltip">GitHub</span>
        </div>
        <!--
          <div id="BlogButton">
            <a href="https://obsproject.com/blog">
              <i class="icon-blog"></i>
            </a>
          </div>

          <div id="LivechatButton">
            <a href="https://obsproject.com/chat" target="_blank">
              <i class="icon-comment">Gemenskapschatt</i>
            </a>
          </div>
        -->

        <div id="ContributeButton">
          <a href="https://obsproject.com/contribute">
            <i class="icon-heart">Donera</i>
          </a>
        </div>

      </div>

      <nav>

  <ul class="menu cf">
          <li>
                <a  href="https://obsproject.com/sv">Hem</a>

        
      </li>
          <li>
                <a  href="https://obsproject.com/sv/download">Ladda ned</a>

        
      </li>
          <li>
                <a  class="active" href="https://obsproject.com/sv/blog">News</a>

        
      </li>
          <li>
                <a  href="https://obsproject.com/sv/help">Hjälp</a>

        
      </li>
          <li>
                <a  href="https://obsproject.com/forum/">Forum</a>

        
      </li>
      </ul>

</nav>
    </header>
<div class="pagewidth">

  <div class="headerpusher"></div>

  <div class="med_width">

    <div class="bpheader">
      <h1>OBS Latest News</h1>

      <p>Sorry, this page is only available in English</p>    </div>

    <article class="blogpost">
      <header>
        <h2>
          What happened with 27.2: The tale of a legendary hotfix        </h2>
      </header>

      
<div class="bpheader cf">

  <!-- Author -->
      <div class="bpinfo bpauthor">
              <a href="https://obsproject.com/sv/blog/author/Lain">
          by Lain        </a>
          </div>
  
  <!-- Date -->
  <div class="bpinfo bpdate">
    <time datetime="2022-02-23 08:30:00">
      February 23rd, 2022    </time>
  </div>

  <!-- Tags -->
  <!-- Valid: 0 -->
  
  <br />

</div>
<!-- End Post Header -->
      <div class="bp_content">
        <p>That was a crazy week. Let’s talk about what happened with 27.2 and what we had to do this past week.</p>
<p>With the Windows version of 27.2, we updated all of our dependencies. A dependency is a library made from external source code; something which is not OBS source code, but that OBS depends upon for major functionality and features. Sometimes this can be a feature such as software H.264 encoding, which relies on the x264 encoder library, or a feature such as the browser source, which relies on a much bigger dependency: Chromium (the browser engine that powers Google Chrome). More specifically, the browser source utilizes the Chromium Embedded Framework (CEF) to render a webpage as a source, or to render a webpage as a panel inside of OBS.</p>
<p>On Windows, before OBS 27.2, our browsers were stuck on Chromium version 75 because we had to use a complex custom Chromium patch to be able to use it with reasonable performance, and that patch was incompatible with newer versions. Chromium 75 was almost three years old as of 27.2, and many important features and changes have been added to Chromium since then; features and changes which are essential to modern production components such as stream overlays and advanced production displays. It was getting very outdated, so needless to say, it was a high priority for us to update Chromium as a dependency, and thanks to the effort of OBS Project members Pat, Dillon, Matt, pkv, as well as some wonderful people who contribute to the Chromium Embedded Framework, we were finally able to update it to version 95.</p>
<p>However, updating dependencies, especially dependencies that large, can pose some challenges: during the 27.2 release, we started to get sporadic reports of people’s entire computers freezing, requiring a full system reboot. We immediately began investigating, and at first I slowed, then eventually reverted the release of 27.2 as more reports came in confirming the issue. On the first day after 27.2, we were frantically trying to find affected users who would have the patience to allow us to examine and understand what was happening. Fortunately, we found some very kind users who were able to force a bluescreen during the system freeze and generate debug dump files of their system kernels. This allowed us to get the first hint of what was happening: it was very likely a bug in the graphics driver. We noticed it was centered around graphics operations, and it was only happening with one graphics card manufacturer. Fortunately, we have contacts with all the major graphics card manufacturers, so we immediately got in contact with them to file a driver bug report.</p>
<p>Being that we were in no position to expect a graphics card manufacturer to debug and fix a suspected driver bug in a timely manner, let alone expect users to update to those drivers within any reasonable timeframe after their release, we had no choice: either find a workaround soon, or revert Chromium back to version 75. Considering so much effort in this update was spent updating Chromium to improve stream production features for users, reverting Chromium back to 75 was not the option I wanted to take. I had to do something, and soon, as Twitch was deprecating their v5 API in two weeks, meaning that old versions of OBS would no longer be able to use the “Connect Account” feature with Twitch.</p>
<p>R1CH, a contributor to OBS, had figured out a way to reproduce the system freeze: add a bunch of very active browser sources, and run OBS in 1300/1 fractional framerate (i.e. 1300 frames per second). This did the trick, and we were now able to reproduce the issue ourselves and debug it a bit more easily. While debugging the bluescreen kernel dumps, I immediately suspected what the problem was likely triggered by: the IDXGIKeyedMutex API. This API is used to lock and synchronize shared graphics memory between two different processes or threads on the system; our latest Chromium update had been modified to use it, a big change from how Chromium 75 functioned. Being that I am incredibly stubborn, and being that I already hated that API, around two or three days after 27.2 was released, I decided that I had to find out whether or not that was the trigger. For the next day or so after that, I modified and compiled Chromium to remove IDXGIKeyedMutex almost everywhere I could see it. Because Chromium is such a monumentally large project involving tens of millions of lines of code, and because it uses so many layers of abstraction and interprocess communication, I had doubts I would be able to accomplish it; some of our contributors suggested we should just let it go and revert back to Chromium 75. But being incredibly stubborn, after a few days of learning how Chromium works internally, I managed to remove almost all usage of keyed mutexes.</p>
<p>And I couldn’t believe it: it solved the system freeze. It did the trick! I felt like Luke Skywalker in the Death Star’s garbage compactor right after it was deactivated.</p>
<p>However, it introduced a new issue: although it solved the system freeze issue, removing synchronization inevitably caused frame stuttering and frame pacing issues when rendering the browser source. It was noticeable enough that I knew that my job wasn’t finished. For the next sleepless day or two after that, in an attempt to solve this issue, I went to work trying to figure out some other way to synchronize textures shared between Chromium and OBS. Coupled with the fact that Chromium code is so incredibly abstract and relies on so many different separate independent interprocess parts working together, it made the task incredibly difficult. After a day or two of no success, another contributor had suggested that I just let it go, and that it was good enough as-is, and that we had the v5 API deadline. I originally conceded, and let it go, but that same night while I was in the shower, I had an idea of how to solve it!</p>
<p>After that shower, I told the other contributors that I’m going to try one last thing that night, and that if I couldn’t do it before the night was over, I’d give up. In an all-or-nothing last-ditch effort, I spent the rest of the night reprogramming a couple key parts of Chromium to share a single texture with OBS, which would be automatically updated by a simple copy operation from the backbuffer texture: the same exact way that the patch for version 75 accomplished it.</p>
<p>My effort proved fruitful, and not only did it fix the frame stuttering issue, but it also vastly improved performance of the Chromium 95 build. Not only did we fix the system freeze and fix frame stuttering, we also greatly improved browser source performance!</p>
<p>Words can’t describe how good it felt. My elation went from simply getting out of the garbage compactor on the Death Star to blowing up the entire Death Star in one fell swoop. We tested it with everyone we could: everyone confirmed that all of their issues were fixed, and that the browser source was performing better than ever. After an entire week of sleepless toil, we’re now here with 27.2.1, a legendary hotfix. It was the worst week of my life that somehow turned into the best week of my life.</p>
<p>I want to make a big shout out to the very patient users who purposely crashed their PCs to get us kernel dumps, a big shout out to R1CH for figuring out a way to reproduce the system freeze reliably, and a big shoutout to Matt, pkv, Flaeri, Shaolin, RytoEX, Ace, and everyone else who spent time testing different builds on different systems. Thank you all. Without all of our wonderful contributors working together, none of this would have been possible.</p>
<p>What an incredibly crazy week. I can finally get some sleep again.</p>      </div>

    </article>

  </div>

</div>

  <div class="footer_push"></div>
</div>
<!-- End Wrapper -->
  
  <footer id="footer" class="footer cf">
    <div class="footer_extra">
      <div class="footer_left">
        <div class="footer_row">
          <div class="logo"><img src="https://obsproject.com/assets/images/new_icon_small-r.png"></div>
          <div class="footer_title">OBS Project</div>
        </div>
        <div class="footer_row footer_social">
          <a href="https://twitter.com/OBSProject" target="_blank" aria-label="OBS Twitter">
            <i class="icon-twitter"></i>
          </a>
          <a href="https://facebook.com/OpenBroadcasterSoftware" target="_blank" aria-label="OBS Facebook">
            <i class="icon-facebook"></i>
          </a>
          <a href="https://obsproject.com/discord" target="_blank" aria-label="OBS Discord">
            <img src="https://obsproject.com/assets/images/Discord.svg" class="icon-discord">
          </a>
          <a href="https://github.com/obsproject/obs-studio" target="_blank" aria-label="OBS GitHub">
            <i class="icon-github"></i>
          </a>
        </div>
      </div>
      <div class="footer_right">

        <!-- App -->
        <div class="footer_items"><div class="footer_category">OBS Studio</div>
          <a href="https://obsproject.com/download" aria-label="Download">Download</a>
          <a href="https://ideas.obsproject.com/" target="_blank" aria-label="Feature suggestions">Ideas</a>
          <a href="https://obsproject.com/privacy-policy" aria-label="Privacy Policy">Privacy Policy</a>
        </div>

        <!-- Contribute -->
        <div class="footer_items"><div class="footer_category">Contribute</div>
          <a href="https://github.com/obsproject/obs-studio" target="_blank" aria-label="OBS GitHub">GitHub</a>
          <a href="https://opencollective.com/obsproject" aria-label="OBS on Open Collective">Open Collective</a>
          <a href="https://www.patreon.com/obsproject/overview" aria-label="OBS on Patreon">Patreon</a>
        </div>

        <!-- Help -->
        <div class="footer_items"><div class="footer_category">Support</div>
          <a href="https://obsproject.com/help" aria-label="Help Portal">Help Portal</a>
          <a href="https://obsproject.com/forum/" aria-label="Forums">Forums</a>
          <a href="https://obsproject.com/discord" aria-label="Official Discord">Discord</a>
          <a href="https://obsproject.com/wiki" aria-label="Support Wiki">Wiki</a>
        </div>

      </div>
    </div>

    <div class="copyright">
      <p>© 2012 - 2023. OBS and OBS Studio are created and maintained by Lain. Development by <a href="https://github.com/obsproject/OBS-studio/graphs/contributors">OBS Studio Contributors</a>.<br />
Website designed and created by <a href="https://twitter.com/Warchamp7">Warchamp7</a>, powered by <a href="https://getkirby.com/made-with-kirby-and-love">Kirby CMS</a>. Downloads powered by <a href="https://fastly.com/">Fastly</a>.</p>    </div>
    <br>
    <div class="languages" arial-label="Select Language">
    <p>
                          <a href="https://obsproject.com/cs/blog/the-tale-of-a-legendary-hotfix">Čeština</a> 
                                  <a href="https://obsproject.com/da/blog/the-tale-of-a-legendary-hotfix">Dansk</a> 
                                  <a href="https://obsproject.com/de/blog/the-tale-of-a-legendary-hotfix">Deutsch</a> 
                                  <a href="https://obsproject.com/blog/the-tale-of-a-legendary-hotfix">English</a> 
                                  <a href="https://obsproject.com/es/blog/the-tale-of-a-legendary-hotfix">Español</a> 
                                  <a href="https://obsproject.com/eu/blog/the-tale-of-a-legendary-hotfix">Euskara</a> 
                                  <a href="https://obsproject.com/fi/blog/the-tale-of-a-legendary-hotfix">Suomi</a> 
                                  <a href="https://obsproject.com/fr/blog/the-tale-of-a-legendary-hotfix">Français</a> 
                                  <a href="https://obsproject.com/hu/blog/the-tale-of-a-legendary-hotfix">Magyar</a> 
                                  <a href="https://obsproject.com/ja/blog/the-tale-of-a-legendary-hotfix">日本語</a> 
                                  <a href="https://obsproject.com/ko/blog/the-tale-of-a-legendary-hotfix">한국어</a> 
                                  <a href="https://obsproject.com/pt-br/blog/the-tale-of-a-legendary-hotfix">Português do Brasil</a> 
                                  <a href="https://obsproject.com/ru/blog/the-tale-of-a-legendary-hotfix">ру́сский</a> 
                                                <a href="https://obsproject.com/tr/blog/the-tale-of-a-legendary-hotfix">Türkçe</a> 
                                  <a href="https://obsproject.com/uk/blog/the-tale-of-a-legendary-hotfix">українська</a> 
                                  <a href="https://obsproject.com/zh-cn/blog/the-tale-of-a-legendary-hotfix">中文(简体)</a> 
                  </p>
    </div>

  </footer>
</body>

<!-- Mirrored from obsproject.com/sv/blog/the-tale-of-a-legendary-hotfix by HTTrack Website Copier/3.x [XR&CO'2014], Sun, 31 Dec 2023 03:57:04 GMT -->
</html>
